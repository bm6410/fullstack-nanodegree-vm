{% extends "layout.html" %}

{% block title %}Add a Poster{% endblock %}
{% block content %}

	<!--TODO: add validation from bootstrap-->

	<div class="container">
		<div class="row">
			<h1 class="heading-text">Add New Poster</h1>
		</div>
		<form action="{{url_for('addNewPoster')}}" class="needs-validation" method = 'post' enctype=multipart/form-data>
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="title">Title</label>
						<input type="text" class="form-control" name="title" id='title' style="min-width: 200px;" required>
					</div>
					<div class="valid-feedback">
        				Looks good!
      				</div>
					<div class="form-group">
						<label for="year">Release Date</label>
						<input type="text" class="form-control" name='year' id="year" required>
					</div>
					<div class="form-group">
						<label for="director">Director</label>
						<input type="text" class="form-control" name='director' id="director" style="min-width: 200px;" required>
					</div>
					<div class="form-group">
						<label for="genre">Genre</label>
						<select name='genre' id="genre" class="custom-select">
							{% for genre in genres %}
							<option value={{genre.id}}>{{genre.name}}</option>
							{% endfor %}
						</select>
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="poster_img">Poster Image</label>
						<!--<form id="form1" runat="server">-->
							<!--<div class="alert"></div>-->
							<div id='img_contain'><img class="img-fluid" id="blah" src="http://www.clker.com/cliparts/c/W/h/n/P/W/generic-image-file-icon-hi.png" alt="your image" title=''/></div>
						  <!--input type='file' id="imgInp" /--->
						  <div class="input-group">
						  <div class="custom-file">
							<input type="file" name='poster_img' id="poster_img" class="imgInp custom-file-input" aria-describedby="inputGroupFileAddon01">
							<label class="custom-file-label" for="poster_img">Choose file</label>
						  </div>
						</div>
						<!--</form>-->
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col text-right">
					<div class="form-group">
						<a href="{{url_for('showHomePage')}}" class="btn btn-outline-light my-2 my-sm-0">Cancel</a>
						<button class="btn btn-outline-light my-2 my-sm-0" type='submit'>Create Poster Entry</button>
					</div>
				</div>
			</div>
		</form>
	</div>

	<script>
		// TODO: need to give credit for this one https://codepen.io/gab5a430/pen/jPNXeX
		function readURL(input) {

		  if (input.files && input.files[0]) {
			var reader = new FileReader();
			var filename = $("#poster_img").val();
			filename = filename.substring(filename.lastIndexOf('\\')+1);
			reader.onload = function(e) {
			  $('#blah').attr('src', e.target.result);
			  $('#blah').hide();
			  $('#blah').fadeIn(500);
			  $('.custom-file-label').text(filename);
			}
			reader.readAsDataURL(input.files[0]);
		  }
		  $(".alert").removeClass("loading").hide();
		}

		$("#poster_img").change(function(event) {
		  RecurFadeIn();
		  readURL(this);
		});

		function RecurFadeIn(){
		  console.log('ran');
		  FadeInAlert("Wait for it...");
		}
		function FadeInAlert(text){
		  $(".alert").show();
		  $(".alert").text(text).addClass("loading");
		}

// TODO: do something with this
// Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();

	</script>

{% endblock %}